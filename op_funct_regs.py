import re 
# **Bước 1: Khai báo bảng băm OPCODE, REG và FUNCT**
OPCODES = {
    "ADD": "0110011",
    "SUB": "0110011",
    "ADDI": "0010011",
    "LUI": "0110111",
    "AUIPC": "0010111",
    "LB": "0000011",
    "LBU": "0000011",
    "LH": "0000011",
    "LHU": "0000011",
    "LW": "0000011",
    "SB": "0100011",
    "SH": "0100011",
    "SW": "0100011",
    "SLL": "0110011",
    "SLLI": "0010011",
    "SRL": "0110011",
    "SRLI": "0010011",
    "SRA": "0110011",
    "SRAI": "0010011",
    "XOR": "0110011",
    "XORI": "0010011",
    "OR": "0110011",
    "ORI": "0010011",
    "AND": "0110011",
    "ANDI": "0010011",
    "SLT": "0110011",
    "SLTI": "0010011",
    "SLTU": "0110011",
    "SLTIU": "0010011",
    "BEQ": "1100011",
    "BNE": "1100011",
    "BLT": "1100011",
    "BGE": "1100011",
    "BLTU": "1100011",
    "BGEU": "1100011",
    "JAL": "1101111",
    "JALR": "1100111",
}

FUNCT3 = {
    "ADD": "000",
    "JALR": "000",
    "SUB": "000",
    "ADDI": "000",
    "LB": "000",
    "LBU": "100",
    "LH": "001",
    "LHU": "101",
    "LW": "010",
    "SB": "000",
    "SH": "001",
    "SW": "010",
    "SLL": "001",
    "SLLI": "001",
    "SRL": "101",
    "SRLI": "101",
    "SRA": "101",
    "SRAI": "101",
    "XOR": "100",
    "XORI": "100",
    "OR": "110",
    "ORI": "110",
    "AND": "111",
    "ANDI": "111",
    "SLT": "010",
    "SLTI": "010",
    "SLTU": "011",
    "SLTIU": "011",
    "BEQ": "000",
    "BNE": "001",
    "BLT": "100",
    "BGE": "101",
    "BLTU": "110",
    "BGEU": "111",
}

FUNCT7 = {
    "ADD": "0000000",
    "SUB": "0100000",
    "SLL": "0000000",
    "SRL": "0000000",
    "SRA": "0100000",
    "AND": "0000000",
    "OR": "0000000",
    "XOR": "0000000",
    "SLT": "0000000",
    "SLTU": "0000000",
}

REGISTERS = {
    f"X{i}": {
        "binary": f"{i:05b}",  # Mã nhị phân 5 bit
        "value": 0            # Giá trị mặc định ban đầu
    }
    for i in range(32)
}

REGISTER_ALIAS = {
    "X0": "X0", "X1": "X1", "X2": "X2", "X3": "X3", "X4": "X4", 
    "X5": "X5", "X6": "X6", "X7": "X7", "X8": "X8", "X9": "X9", 
    "X10": "X10", "X11": "X11", "X12": "X12", "X13": "X13", "X14": "X14", 
    "X15": "X15", "X16": "X16", "X17": "X17", "X18": "X18", "X19": "X19", 
    "X20": "X20", "X21": "X21", "X22": "X22", "X23": "X23", "X24": "X24", 
    "X25": "X25", "X26": "X26", "X27": "X27", "X28": "X28", "X29": "X29", 
    "X30": "X30", "X31": "X31", 
    "ZERO": "X0", "RA": "X1", "SP": "X2", "GP": "X3", "TP": "X4", 
    "T0": "X5", "T1": "X6", "T2": "X7", "S0": "X8", "FP": "X8", 
    "S1": "X9", "A0": "X10", "A1": "X11", "A2": "X12", "A3": "X13", 
    "A4": "X14", "A5": "X15", "A6": "X16", "A7": "X17", "S2": "X18", 
    "S3": "X19", "S4": "X20", "S5": "X21", "S6": "X22", "S7": "X23", 
    "S8": "X24", "S9": "X25", "S10": "X26", "S11": "X27", "T3": "X28", 
    "T4": "X29", "T5": "X30", "T6": "X31",
}

# Hàm ánh xạ thanh ghi

def map_register(register_name):
    if register_name in REGISTER_ALIAS:
        return REGISTER_ALIAS[register_name]
    raise ValueError(f"Thanh ghi không hợp lệ: {register_name}")
